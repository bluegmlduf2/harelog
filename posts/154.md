---
title: "네트워크 데이터 흐름 정리"
date: 2023-08-30
category: network
---

#### 데이터구조**캡슐화된 데이터의 구조 (https://forgarden.tistory.com/9)**

#### 구글에 데이터를 보내기 까지**사용자 컴퓨터에서 구글에 연결되기까지 (https://lamarr.dev/networkingbeginner/2020/03/23/13.html)**

// 아래의 내용은 위의 사이트를 참조한것입니다

1. **이용자의 통신 요청 및 사전준비**

   이용자는 웹 브라우저에서 Google의 도메인 주소를 입력하고, HTTPS 프로토콜로 통신을 시작한다. DNS 서버로부터 구글의 IP 주소를 받아온다. ( Layer7 )
2. **3-way-handshake**: 이용자의 컴퓨터와 구글 서버는 TCP 프로토콜을 이용하여 연결을 확립한다.
3. **이용자 데이터의 캡슐화**

   데이터를 보낼 때, 각 계층에서 헤더를 붙여 데이터를 캡슐화한다.

   | 계층 | 프로토콜명 | 캡슐 데이터명 | 해당 데이터가 사용될 장비명 | 기타 |
   | --- | --- | --- | --- | --- |
   | L5 ~ L7 | HTTPS | 데이터 | 상대방 PC |  |
   | L4 | TCP | 세그먼트 | 상대방 PC |  |
   | L3 | IP | 패킷 | 라우터 |  |
   | L2 | Ethernet | 프레임 | 스위치 허브 |  |
   | L1 |  |  | 랜 카드(NIC) | 디지털 데이터 ↔ 디지털 전기 신호 |
4. **물리적 전송**

   물리 계층에서는 캡슐화한 디지털 데이터를 디지털 전기 신호로 변환하여 스위치로 데이터를 보낸다.
5. **스위치(허브)에서의 처리**

   스위치는 MAC 주소를 통해 어느 포트로 데이터를 전송할지 결정한다.
6. **라우터에서의 처리**

   라우터는 IP 주소를 확인하고 라우팅 테이블을 통해 다음 경로를 결정한다

   만약 출발지의 IP가 사설IP라면 출발지의 IP를 공인IP로 변경한다 (NAT)

   다음 목적지의 라우터에 도착하면 해당 IP가 있는지 확인하기 위해 역캡슐화를 하고 일치하는 목적지 IP가 없으면 다음 MAC주소로 수정후 캡슐화하고 다음으로 전송하다.

   목적지에 도착할때까지 위의 과정을 반복한다
7. **목적지 도착**

   마지막 라우터는 목적지까지의 경로를 알고, 데이터를 해당 서버에 전달한다.
8. **서버에서의 데이터 처리**

   구글 서버는 데이터를 역캡슐화하고, 필요한 정보를 추출한 후 웹페이지를 이용자에게 전송한다

## 디지털 데이터 / 디지털 전기 신호 / 아날로그 신호

#### 컴퓨터에서 외부 네트워크로의 데이터 신호 변환 과정

컴퓨터 내부에서는 **디지털 데이터**를 사용합니다.

랜카드(NIC)를 거쳐 LAN 케이블과 모뎀을 통해 외부로 나갈 때까지 **디지털 전기 신호**로 변환됩니다.

모뎀을 나서면 **아날로그 신호**로 전송됩니다.

![(디지털신호 / 아날로그신호)](/storage/1693403760.jpg)**디지털 데이터**

이는 컴퓨터 내부에서 처리되는 정보의 형태입니다.

예를 들어, 텍스트 파일, 이미지, 오디오 파일 등이 모두 디지털 데이터로 저장됩니다.

이 데이터는 0과 1로 이루어진 이진 형태로 존재합니다.

(실질적인 0,1데이터)

**디지털 전기 신호**

디지털 데이터를 LAN 케이블등을 사용해서 네트워크 장비간 전송하기 위해서는 이를 전기신호로 변환해야 합니다.

이 때 사용되는 것이 디지털 전기신호입니다. 예를 들어, Ethernet 케이블을 통한 데이터 전송에서는 디지털 전기신호를 사용합니다.

이 신호는 일반적으로 높은 전압과 낮은 전압의 두 가지 상태로 표현되며, 이러한 상태의 전환은 디지털 데이터의 0과 1을 나타냅니다.

( 예를들면 0V 와 5V 두개만 존재한다고 보면된다)

**아날로그신호**

아날로그 신호는 연속적인 값을 가집니다.

예를 들어, 전화선을 통한 음성 통신에서 사용되는 신호는 아날로그 신호입니다.

( 예를 들면 0V ~ 5V 까지의 과정을 아날로그 신호라고한다)

## 네트워크장비 (노드)

**리피터 ( Layer1 )**

약해진 디지털 전기신호를 증폭시킨다 ( 거리가 멀어지면 신호가 약해짐 )

**브릿지 ( Layer2)**

서로 다른 세그먼트를 연결함( 세그먼트란 네트워크상의 단일 기기롭터 송출된 패킷이 무조건 도달할수있는 범위)

디지털 전기신호를 증폭시킨다

이전에 데이터를 주고받을때 MAC주소를 기억후 그 이후에 데이터가 전달되면 거기로 보낸다 ( 네트워크 효율성 증가)

**라우터 ( Layer3 )**

데이터를 라우팅 테이블을 참조해서 보내거나 받는다 (라우팅 테이블)

만약 송수신데이터의 IP주소가 자신이 속한 네트워크라면 외부로 데이터를 전달하지않고 내부에 전달한다

반대로 외부에 보내야하는 데이터면 외부에 전달한다 ( 데이터를 내부로 전달할지 외부로 전달할지 결정함 )

또한 사설IP로 외부와 통신할때 사설IP를 공개IP로 변경해주는 역할도 한다 (NAT)

그리고 일반적으로 LAN과 외부네트워크의 출입구를 게이트웨이라고 하는데 라우터를 말한다 (게이트웨이)

일반적으로 가정용 공유기등이 스위칭허브와 라우터기능을 같이 가지고 있다 (공유기)

##### 허브 ( Layer1 )

LAN케이블을 연결하는 집선 장치이다

포트 수 대로 늘릴수있다

리피터 기능이 있다

( 무조건 수신 받을 데이터를 모든 포트에 분배하기에 비효율적이다)

##### 스위치 허브 ( Layer2 )

LAN케이블을 연결하는 집선 장치이다

그러나 허브와 다르게 데이터를 수신받을때 MAC주소를 저장하고 기억후

해당 포트에만 데이터를 전달한다

( 수신 받을 데이터를 특정 포트에 분배하기에 효율적이다)

( 브릿지와 허브를 섞은 느낌 )

그래서 허브보다 많이 사용한다

---

**참고**

[구글에 데이터를 보내면 어떻게되는가](https://lamarr.dev/networkingbeginner/2020/03/23/13.html)

[캡슐화된 데이터](https://forgarden.tistory.com/9)
